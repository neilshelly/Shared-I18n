Replit Audit Prompt:

You are auditing the existing `shared-i18n` repository.

Before making any changes, read and treat as authoritative the following documents that will be provided to you:

1. Shared Translation Architecture
2. Web Suite System Architecture and Trust Boundaries
3. Engineering Baseline for Web Clients
4. Repo Template and Environment Variable Matrix

Do not assume prior behavior. Re-read the repo and the documents carefully.

Your task is to:

* Audit the repo for compliance with the authoritative documents.
* Report findings as Pass/Fail per checklist section.
* Apply minimal, document-driven fixes where failing.
* Do not expand architecture.
* Do not introduce new capabilities.
* Do not add runtime i18n logic.
* Do not introduce environment variables.
* Do not introduce API calls or service behavior.
* Keep changes minimal and compliant.

After fixes, re-run validation and build, and confirm compliance.

Audit Checklist (must be covered and reported)

1. Repo Identity and Boundaries

Confirm:

* This is a package repo, not a service.
* No API routes, no HTTP logic, no auth.
* No environment variables.
* No runtime i18n helpers (no translate() function, no locale resolver, no formatting helpers).
* Only static locale catalogues and generated types are exported.

If any violations exist, remove them.

2. Catalogue Correctness

Verify:

* `src/locales/en.json` exists.
* `src/locales/de-DE.json` exists.
* en.json is treated as canonical.
* All locale JSON files:

  * are valid JSON.
  * are flat key:string maps (no nested objects).
  * contain identical key sets.
  * have identical placeholder names per key.
  * contain no malformed `{{` without matching `}}`.

Run `npm run validate`.

If validate does not fail correctly on mismatch, fix the validator.

If build does not depend on validation, fix scripts so validation is enforced.

3. Validation and Script Integrity

Confirm:

* `npm run validate` exists.
* `npm run gen` exists.
* `npm run build` runs generation and then TypeScript build.
* `npm test` runs generation + validation + unit tests.
* Build fails if validation fails.
* Tests are deterministic and minimal.
* Validator can be executed programmatically for testing (core function exported).

If any scripts are missing or miswired, correct package.json.

If Replit blocks editing package.json directly, overwrite it using a shell heredoc and re-run npm install.

4. Generated Type Contract

Confirm:

* `TranslationKey` and `translationKeys` are generated automatically from `src/locales/en.json`.
* No manual union definitions exist in source files.
* Generated file is deterministic and sorted.
* Generation runs during test and build.
* `src/index.ts` exports:

  * `TranslationKey`
  * `translationKeys`
  * `en`
  * `deDE`

Verify consumers can import from built output:

* `import { TranslationKey, translationKeys, en, deDE } from './dist/index.js'`

If generation is not automatic or unions are handwritten, fix by enforcing generator usage.

5. Package Metadata

Verify package.json:

* name: "shared-i18n"
* version present
* private: false
* type: "module"
* main/module/types point to dist outputs
* exports map exposes root entry correctly
* optionally supports `./locales/*` if implemented
* files includes `dist/` and `src/locales/`
* sideEffects: false
* publishConfig access public
* scripts include: gen, validate, build, test, prepublishOnly

If misconfigured, fix with minimal edits.

6. Documentation Compliance

Open README.md and confirm it states:

* en.json is canonical.
* All locales must match keys and placeholders exactly.
* TranslationKey and translationKeys are generated from en.json.
* Manual union maintenance is prohibited.
* Consumers import types from shared-i18n.
* Consumers merge shared catalogue with app-specific catalogues at runtime.
* Versioning rules:

  * major for removal, rename, placeholder structure changes
  * minor for additive keys
  * patch for packaging/docs only
* Repo contains no runtime i18n logic beyond static catalogues and generated types.
* Ownership boundaries are described correctly.

If missing, minimally update README to match architecture doc.

Audit Procedure

1. Run:

   * npm run validate
   * npm test
   * npm run build

2. Record Pass/Fail for each checklist section.

3. Apply minimal fixes for any Fail.

4. Re-run:

   * npm run validate
   * npm test
   * npm run build

5. Provide final report:

* Section 1: Pass/Fail
* Section 2: Pass/Fail
* Section 3: Pass/Fail
* Section 4: Pass/Fail
* Section 5: Pass/Fail
* Section 6: Pass/Fail
* Summary: Fully compliant / Non-compliant with reasons

Do not introduce new architectural features.
Do not expand scope beyond authoritative documents.
Keep changes minimal and standards-aligned.

Verification Checklist (run after audit)

* npm run validate
* npm test
* npm run build
* node -e "import { translationKeys } from './dist/index.js'; console.log(Array.isArray(translationKeys), translationKeys.length)"
* node -e "import { en, deDE } from './dist/index.js'; console.log(typeof en, typeof deDE)"
